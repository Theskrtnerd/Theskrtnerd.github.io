<!DOCTYPE html>
<html lang="en" dir="auto">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="noindex, nofollow">
<title>Sort everything in Hack Assembly | BT</title>
<meta name="keywords" content="sorting, coding, uni, random">
<meta name="description" content="Imagine spending 6 hours just to put a ball into the net. That&#39;s what happened with me the other day when I tried doing my Computer Systems assignment...">
<meta name="author" content="xineohperif">
<link rel="canonical" href="http://localhost:1313/posts/sorting-in-hack-assembly/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.b609c58d5c11bb90b1a54e04005d74ad1ddf22165eb79f5533967e57df9c3b50.css" integrity="sha256-tgnFjVwRu5CxpU4EAF10rR3fIhZet59VM5Z&#43;V9&#43;cO1A=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://localhost:1313/apple-touch-icon.png">
<link rel="mask-icon" href="http://localhost:1313/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="http://localhost:1313/posts/sorting-in-hack-assembly/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/" accesskey="h" title="BT (Alt + H)">
                <img src="http://localhost:1313/logo.png" alt="" aria-label="logo"
                    height="35">BT</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://localhost:1313/about/" title="About">
                    <span>About</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/posts/" title="Blog">
                    <span>Blog</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/projects/" title="Projects">
                    <span>Projects</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/updates/" title="Updates">
                    <span>Updates</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      Sort everything in Hack Assembly
    </h1>
    <div class="post-description">
      Imagine spending 6 hours just to put a ball into the net. That&#39;s what happened with me the other day when I tried doing my Computer Systems assignment...
    </div>
    <div class="post-meta"><span title='2024-05-03 00:00:00 +0000 UTC'>May 3, 2024</span>&nbsp;·&nbsp;xineohperif

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#introduction" aria-label="Introduction">Introduction</a></li>
                <li>
                    <a href="#struggling-with-sorting" aria-label="Struggling with Sorting">Struggling with Sorting</a></li>
                <li>
                    <a href="#conclusion" aria-label="Conclusion">Conclusion</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h2 id="introduction">Introduction<a hidden class="anchor" aria-hidden="true" href="#introduction">#</a></h2>
<p>This semester, I had the chance to study the course <a href="https://www.adelaide.edu.au/course-outlines/001956/2/sem-1/">Computer Systems</a>. This course is (kinda) based on the course <a href="https://www.nand2tetris.org">nand2tetrus</a> and the book <a href="https://www.amazon.com/Elements-Computing-Systems-Building-Principles/dp/0262640686/">The Elements of Computing Systems</a>. The course is famous and notorious for being hard, but it teaches you all the fundamentals of Computing Systems, from high-level languages like Python and C++, all the way down to machine code with 0 and 1 bits. </p>
<p>So it might be obvious that this course is regarded as the hardest in my entire CS degree. Furthermore, you can probably guess how hard the assignments were. Especially in the recent assignment, we were tasked with writing <a href="https://www.jk-quantized.com/experiments/HomebrewComputer/Cheatsheets/hackASM.html">Hack Assembly</a> code, which is an Assembly language that is created for the Hack Platform, with all basic components of a normal computer with CPU and RAM, etc. This language at first looks super hard to read, with some weird syntax. Below is a small snippet of what the code looks like.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sample.asm" data-lang="sample.asm"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">@</span><span style="color:#a6e22e">R1</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">D</span><span style="color:#960050;background-color:#1e0010">=</span>M
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">@</span><span style="color:#a6e22e">x</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">M</span><span style="color:#960050;background-color:#1e0010">=</span>D <span style="color:#f92672">//</span> x <span style="color:#960050;background-color:#1e0010">=</span> R1
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">@</span><span style="color:#a6e22e">R2</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">D</span><span style="color:#960050;background-color:#1e0010">=</span>M
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">@</span><span style="color:#a6e22e">y</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">M</span><span style="color:#960050;background-color:#1e0010">=</span>D <span style="color:#f92672">//</span> y <span style="color:#960050;background-color:#1e0010">=</span> R2
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">@0</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">D</span><span style="color:#960050;background-color:#1e0010">=</span>A
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">@</span><span style="color:#a6e22e">R3</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">M</span><span style="color:#960050;background-color:#1e0010">=</span>D <span style="color:#f92672">//</span> R3 <span style="color:#960050;background-color:#1e0010">=</span> <span style="color:#ae81ff">0</span>
</span></span></code></pre></div><h2 id="struggling-with-sorting">Struggling with Sorting<a hidden class="anchor" aria-hidden="true" href="#struggling-with-sorting">#</a></h2>
<p>I struggled with this assignment a lot. But of all the tasks, the task that interested me the most was the task of writing a sorting algorithm in a file called <code>ArrSort.asm</code> using this language.</p>
<p>This task was not that difficult, but what was challenging was the bonus part, where you can receive bonus marks for implementing an algorithm in <code>O(nlog(n))</code> time complexity. My friend Khanh even talked about not being able to solve this before I started this assignment.</p>
<p>At first, I thought this was going to be a simple task. But then I was (obviously) wrong. The two most famous sorting algorithms that have a <code>O(nlog(n))</code> time complexity are <strong>Merge Sort</strong> and <strong>Quick Sort</strong>.</p>
<p>I first started by trying to implement <strong>Quick Sort</strong> in Assembly. But after trying to implement it for 3 hours, I realized a major issue with this algorithm: This algorithm needs to be implemented recursively, while Hack Assembly cannot implement recursion because this language doesn&rsquo;t have a return address after jumping and PC (Program Counter) integrated. This was a huge shock and letdown for me, as I&rsquo;ve spent 3 hours (late night) for nothing.</p>
<p>After that, I changed to <strong>Merge Sort</strong> and this was a much better solution that can be implemented iteratively. With help from ChatGPT, I was able to come up with this Python code for a high-level implementation:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">merge</span>(arr, r4, r5, r6):
</span></span><span style="display:flex;"><span>    i <span style="color:#f92672">=</span> r4
</span></span><span style="display:flex;"><span>    j <span style="color:#f92672">=</span> r5 <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> i <span style="color:#f92672">&lt;=</span> r5 <span style="color:#f92672">and</span> j <span style="color:#f92672">&lt;=</span> r6:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> arr[i] <span style="color:#f92672">&lt;=</span> arr[j]:
</span></span><span style="display:flex;"><span>            i <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>            temp <span style="color:#f92672">=</span> arr[j]
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> k <span style="color:#f92672">in</span> range(j, i, <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>):
</span></span><span style="display:flex;"><span>                arr[k] <span style="color:#f92672">=</span> arr[k <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>]
</span></span><span style="display:flex;"><span>            arr[i] <span style="color:#f92672">=</span> temp
</span></span><span style="display:flex;"><span>            i <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>            j <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>            r5 <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">merge_sort</span>(arr):
</span></span><span style="display:flex;"><span>    r2 <span style="color:#f92672">=</span> len(arr)
</span></span><span style="display:flex;"><span>    r3 <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> r3 <span style="color:#f92672">&lt;</span> r2:
</span></span><span style="display:flex;"><span>        r4 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">while</span> r4 <span style="color:#f92672">&lt;</span> r2 <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>:
</span></span><span style="display:flex;"><span>            r7 <span style="color:#f92672">=</span> r2 <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>            r5 <span style="color:#f92672">=</span> r3<span style="color:#f92672">+</span>r4<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>            r5 <span style="color:#f92672">=</span> min(r5, r7)
</span></span><span style="display:flex;"><span>            r6 <span style="color:#f92672">=</span> r5<span style="color:#f92672">+</span>r3
</span></span><span style="display:flex;"><span>            r6 <span style="color:#f92672">=</span> min(r6, r7)
</span></span><span style="display:flex;"><span>            merge(arr, r4, r5, r6)
</span></span><span style="display:flex;"><span>            r4 <span style="color:#f92672">+=</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">*</span> r3
</span></span><span style="display:flex;"><span>        r3 <span style="color:#f92672">*=</span> <span style="color:#ae81ff">2</span>
</span></span></code></pre></div><p>Notice how the variables are named from <code>r2</code> to <code>r7</code>. This is because in the Hack Assembly, the variables you use will mostly be from <code>R1</code> to <code>R15</code>. With this naming, it will be easier for me to convert all this code to Hack Assembly. And after another 2 hours of work, I finally came up with this super-long code:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-asm" data-lang="asm"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">@3</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">M</span><span style="color:#960050;background-color:#1e0010">=</span><span style="color:#ae81ff">1</span> <span style="color:#75715e">// r3=1
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">WHILEA</span>)
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">@3</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">D</span><span style="color:#960050;background-color:#1e0010">=</span><span style="color:#66d9ef">M</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">@2</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">D</span><span style="color:#960050;background-color:#1e0010">=</span><span style="color:#66d9ef">D-M</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">@</span><span style="color:#a6e22e">END</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">D</span><span style="color:#75715e">;JGE // while r3&lt;r2
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#960050;background-color:#1e0010">@4</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">M</span><span style="color:#960050;background-color:#1e0010">=</span><span style="color:#ae81ff">0</span> <span style="color:#75715e">// r4 = 0
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">WHILEB</span>)
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">@4</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">D</span><span style="color:#960050;background-color:#1e0010">=</span><span style="color:#66d9ef">M</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">@2</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">D</span><span style="color:#960050;background-color:#1e0010">=</span><span style="color:#66d9ef">D-M</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">@</span><span style="color:#a6e22e">ENDWHILEB</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">D</span><span style="color:#75715e">;JGE // while r4 &lt; r2-1
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#960050;background-color:#1e0010">@2</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">D</span><span style="color:#960050;background-color:#1e0010">=</span><span style="color:#66d9ef">M</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">@7</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">M</span><span style="color:#960050;background-color:#1e0010">=</span><span style="color:#66d9ef">D-1</span> <span style="color:#75715e">// r7 = r2-1
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#960050;background-color:#1e0010">@3</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">...</span>
</span></span></code></pre></div><p>For the full code, access my Github repo <a href="https://github.com/Theskrtnerd/computer-systems">here</a>. This will have all my tasks, with completed test cases to test if the code works.</p>
<h2 id="conclusion">Conclusion<a hidden class="anchor" aria-hidden="true" href="#conclusion">#</a></h2>
<p>So in conclusion, I&rsquo;ve spent six hours (an all-nighter) just for one extra mark. But at least for me, it was super worth it, as I was able to understand assembly code deep down to the RAM and ROM level. Furthermore, I now understand more about sorting algorithms and how they work.</p>
<p>What&rsquo;s even funnier is that I neglected all testing, which contributes many more marks than this bonus part. And luckily, with the automatic extension, I was able to submit all the testing files just one day before the final deadline.</p>
<p>Although I loved this experience, I hope this is the last time I have to write stuff like this, as I&rsquo;m too tired to spend another 6 hours.</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="http://localhost:1313/tags/sorting/">Sorting</a></li>
      <li><a href="http://localhost:1313/tags/coding/">Coding</a></li>
      <li><a href="http://localhost:1313/tags/uni/">Uni</a></li>
      <li><a href="http://localhost:1313/tags/random/">Random</a></li>
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2024 <a href="http://localhost:1313/">BT</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
